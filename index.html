<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>SHANNN</title>
    <meta name="description" content="StreamBox - Platform streaming video dengan Google Drive & Supabase">
    <meta name="theme-color" content="#0a0a0f">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ñ∂</text></svg>">

    <!-- CSS FILES -->
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/layout.css">
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/header.css">
    <link rel="stylesheet" href="styles/watch.css">
    <link rel="stylesheet" href="styles/admin.css">
    <link rel="stylesheet" href="styles/responsive.css">

    <!-- SUPABASE CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="app-container">

        <!-- ========== HEADER ========== -->
        <header class="site-header">
            <div class="header-inner">
                <div class="logo" onclick="Router.navigate('home')">
                    <div class="logo-icon">‚ñ∂</div>
                    <div class="logo-text">SHAN<span>PLAY</span></div>
                </div>
                <nav class="nav-menu" id="navMenu">
                    <div class="nav-link active" data-cat="all" onclick="Router.navigateCategory('all')">Semua</div>
                    <div class="nav-link" data-cat="anime" onclick="Router.navigateCategory('anime')">Anime</div>
                    <div class="nav-link" data-cat="kartun" onclick="Router.navigateCategory('kartun')">Kartun</div>
                    <div class="nav-link" data-cat="movie" onclick="Router.navigateCategory('movie')">Movie</div>
                    <div class="nav-link" data-cat="film" onclick="Router.navigateCategory('film')">Film</div>
                </nav>
                <div class="header-actions">
                    <div id="adminBadgeHeader" class="admin-badge" style="display:none;">ADMIN</div>
                    <button class="btn btn-primary btn-sm" id="loginBtn" onclick="Auth.showLoginModal()">üîë <span class="btn-text">Login</span></button>
                    <button class="btn btn-danger btn-sm" id="logoutBtn" style="display:none;" onclick="Auth.logout()">üö™ <span class="btn-text">Logout</span></button>
                    <button class="hamburger" id="hamburgerBtn" onclick="UI.toggleMobileMenu()"><span></span><span></span><span></span></button>
                </div>
            </div>
        </header>

        <!-- MOBILE MENU -->
        <div class="mobile-menu" id="mobileMenu">
            <div class="nav-link active" data-cat="all" onclick="Router.navigateCategory('all');UI.closeMobileMenu()">Semua</div>
            <div class="nav-link" data-cat="anime" onclick="Router.navigateCategory('anime');UI.closeMobileMenu()">Anime</div>
            <div class="nav-link" data-cat="kartun" onclick="Router.navigateCategory('kartun');UI.closeMobileMenu()">Kartun</div>
            <div class="nav-link" data-cat="movie" onclick="Router.navigateCategory('movie');UI.closeMobileMenu()">Movie</div>
            <div class="nav-link" data-cat="film" onclick="Router.navigateCategory('film');UI.closeMobileMenu()">Film</div>
        </div>

        <!-- ========== MAIN CONTENT ========== -->
        <main class="main-content">

            <!-- HOME PAGE -->
            <div class="page" id="homePage">
                <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;margin-bottom:20px;">
                    <h1 class="section-title" style="margin-bottom:0;" id="homeTitle">üé¨ Semua Koleksi</h1>
                    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap;">
                        <div class="search-box">
                            <span class="search-icon">üîç</span>
                            <input type="text" id="searchInput" placeholder="Cari judul..." oninput="UI.filterContent()">
                        </div>
                        <button class="btn btn-primary btn-sm admin-only" onclick="Admin.showAddContentModal()">‚ûï <span class="btn-text">Tambah</span></button>
                    </div>
                </div>
                <div id="resumeBanner" style="display:none;padding:14px;background:linear-gradient(135deg,rgba(59,130,246,.12),rgba(37,99,235,.08));border:1px solid rgba(59,130,246,.25);border-radius:var(--radius-md);margin-bottom:20px;cursor:pointer;" onclick="Player.resumeLastWatched()">
                    <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
                        <span style="font-size:1.3rem;">‚ñ∂Ô∏è</span>
                        <div>
                            <p style="font-weight:700;color:var(--text-primary);font-size:.9rem;">Lanjutkan Menonton</p>
                            <p id="resumeInfo" style="font-size:.8rem;color:var(--text-secondary);"></p>
                        </div>
                    </div>
                </div>
                <div class="grid-container" id="contentGrid"></div>
                <div class="empty-state" id="emptyState" style="display:none;">
                    <div class="icon">üì≠</div>
                    <p>Belum ada konten.</p>
                </div>
            </div>

            <!-- DETAIL PAGE -->
            <div class="page" id="detailPage">
                <button class="btn btn-secondary btn-sm mb-2" onclick="Router.navigate('home')">‚Üê Kembali</button>
                <div id="detailHeader" style="margin-bottom:24px;"></div>
                <div id="detailSeasons"></div>
            </div>

            <!-- WATCH PAGE -->
            <div class="page" id="watchPage">
                <button class="btn btn-secondary btn-sm mb-2" onclick="Router.goBackFromWatch()">‚Üê Kembali</button>
                <div class="watch-container">
                    <div class="player-section">
                        <div class="player-wrapper" id="playerWrapper">
                            <iframe id="videoPlayer" src="" allow="autoplay; fullscreen; encrypted-media; picture-in-picture" allowfullscreen></iframe>
                            <div class="player-blocker-top"></div>
                            <div class="player-blocker-topbar"></div>
                            <div class="player-blocker-bottom"></div>
                        </div>
                        <div class="video-info">
                            <h2 class="video-title" id="watchTitle"></h2>
                            <div class="video-meta" id="watchMeta"></div>
                        </div>
                        <div id="autoNextBanner" class="auto-next-banner" style="display:none;">
                            <p>‚è≠Ô∏è Berikutnya: <strong id="nextEpName"></strong></p>
                            <button class="btn btn-primary btn-sm" onclick="Player.playNextEpisode()">‚ñ∂ Play</button>
                        </div>
                    </div>
                    <div>
                        <button class="mobile-episode-toggle" onclick="UI.toggleEpisodeSidebar()">üìã Daftar Episode</button>
                        <div class="episode-sidebar" id="episodeSidebar">
                            <div class="sidebar-header">
                                <span>üìã Daftar Episode</span>
                                <span class="ep-count" id="epCount"></span>
                            </div>
                            <div class="season-selector" id="seasonSelector" style="display:none;">
                                <select id="watchSeasonSelect" onchange="UI.changeWatchSeason(this.value)"></select>
                            </div>
                            <div class="episode-list-container" id="episodeListContainer"></div>
                            <button class="load-more-btn" id="loadMoreEpBtn" style="display:none;" onclick="UI.loadMoreEpisodes()">üì• Muat Lebih Banyak</button>
                            <div class="admin-only" style="padding:10px;">
                                <button class="btn btn-primary btn-sm" style="width:100%;" onclick="Admin.showAddEpisodeModal()">‚ûï Tambah Episode</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- FOOTER (KOSONG) -->
        <footer style="padding:1px;"></footer>

    </div>

    <!-- ========== MODALS ========== -->
    <div class="overlay" id="loginOverlay" onclick="Auth.hideLoginModal()"></div>
    <div class="modal" id="loginModal">
        <div class="modal-header">
            <div class="modal-title">LOGIN</div>
            <button class="modal-close" onclick="Auth.hideLoginModal()">‚úï</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">Password</label>
                <input type="password" class="form-input" id="adminPasswordInput" placeholder="Masukkan password admin..." onkeydown="if(event.key==='Enter')Auth.login()">
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="Auth.hideLoginModal()">Batal</button>
            <button class="btn btn-primary" id="loginSubmitBtn" onclick="Auth.login()">Masuk</button>
        </div>
    </div>

    <div class="overlay" id="adminOverlay" onclick="Admin.hideModal()"></div>
    <div class="modal" id="adminModal" style="max-width:560px;">
        <div class="modal-header">
            <div class="modal-title" id="adminModalTitle"></div>
            <button class="modal-close" onclick="Admin.hideModal()">‚úï</button>
        </div>
        <div class="modal-body" id="adminFormContent"></div>
        <div class="modal-footer" id="adminFormAction"></div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <!-- ========== SCRIPTS ========== -->
    <script src="scripts/supabase.js"></script>
    <script src="scripts/utils.js"></script>
    <script src="scripts/data.js"></script>
    <script src="scripts/auth.js"></script>
    <script src="scripts/router.js"></script>
    <script src="scripts/player.js"></script>
    <script src="scripts/auto-next.js"></script>
    <script src="scripts/admin.js"></script>
    <script src="scripts/ui.js"></script>
    <script src="scripts/main.js"></script>

</body>
</html>
